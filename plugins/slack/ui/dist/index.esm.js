var PluginSlack=function(T,e,a,n){"use strict";/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var _={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const j=l=>l.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase().trim(),b=(l,k)=>{const u=a.forwardRef(({color:s="currentColor",size:p=24,strokeWidth:i=2,absoluteStrokeWidth:z,className:P="",children:h,...g},$)=>a.createElement("svg",{ref:$,..._,width:p,height:p,stroke:s,strokeWidth:z?Number(i)*24/Number(p):i,className:["lucide",`lucide-${j(l)}`,P].join(" "),...g},[...k.map(([y,C])=>a.createElement(y,C)),...Array.isArray(h)?h:[h]]));return u.displayName=`${l}`,u};/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const B=b("SlidersHorizontal",[["line",{x1:"21",x2:"14",y1:"4",y2:"4",key:"obuewd"}],["line",{x1:"10",x2:"3",y1:"4",y2:"4",key:"1q6298"}],["line",{x1:"21",x2:"12",y1:"12",y2:"12",key:"1iu8h1"}],["line",{x1:"8",x2:"3",y1:"12",y2:"12",key:"ntss68"}],["line",{x1:"21",x2:"16",y1:"20",y2:"20",key:"14d8ph"}],["line",{x1:"12",x2:"3",y1:"20",y2:"20",key:"m0wm8r"}],["line",{x1:"14",x2:"14",y1:"2",y2:"6",key:"14e1ph"}],["line",{x1:"8",x2:"8",y1:"10",y2:"14",key:"1i6ji0"}],["line",{x1:"16",x2:"16",y1:"18",y2:"22",key:"1lctlv"}]]);/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const A=b("ToggleLeft",[["rect",{width:"20",height:"12",x:"2",y:"6",rx:"6",ry:"6",key:"f2vt7d"}],["circle",{cx:"8",cy:"12",r:"2",key:"1nvbw3"}]]);/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const E=b("ToggleRight",[["rect",{width:"20",height:"12",x:"2",y:"6",rx:"6",ry:"6",key:"f2vt7d"}],["circle",{cx:"16",cy:"12",r:"2",key:"4ma0v8"}]]);/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const L=b("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]),t={primary:"#13715B",primaryHover:"#0f604d",textSecondary:"#344054",textTertiary:"#667085",background:"#ffffff",backgroundSecondary:"#f9fafb",backgroundHover:"#f5f5f5",border:"#d0d5dd",borderLight:"#e5e7eb",disabled:"#E5E7EB"},d={sizes:{sm:"12px",md:"13px"},weights:{medium:500,semibold:600}},W={md:"8px"},c={header:{backgroundColor:t.backgroundSecondary,fontWeight:d.weights.semibold,fontSize:d.sizes.sm,color:t.textTertiary,textTransform:"uppercase",padding:"12px 16px"},cell:{fontSize:d.sizes.md,color:t.textSecondary,padding:"12px 16px",borderBottom:`1px solid ${t.borderLight}`},row:{"&:hover":{backgroundColor:t.backgroundHover}}},I=({pluginKey:l="slack",slackClientId:k,slackOAuthUrl:u="https://slack.com/oauth/v2/authorize",onToast:s,apiServices:p})=>{const[i,z]=a.useState([]),[P,h]=a.useState(!1),[g,$]=a.useState([]),[y,C]=a.useState(0),[w,H]=a.useState(5),[M,S]=a.useState(!1),v=p||{get:async o=>({data:await(await fetch(`/api${o}`)).json()}),post:async(o,r)=>({data:await(await fetch(`/api${o}`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(r)})).json()}),patch:async(o,r)=>({data:await(await fetch(`/api${o}`,{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify(r)})).json()}),delete:async o=>{await fetch(`/api${o}`,{method:"DELETE"})}},f=a.useCallback(async()=>{var o;try{h(!0);const r=await v.get(`/plugins/${l}/oauth/workspaces`);z(((o=r.data)==null?void 0:o.data)||[])}catch(r){console.error("Failed to fetch Slack workspaces:",r)}finally{h(!1)}},[l]);a.useEffect(()=>{f()},[f]);const N=()=>{if(!k){console.warn("Slack Client ID not configured");return}const o=encodeURIComponent(`${window.location.origin}/plugins/${l}/manage`),r=encodeURIComponent("incoming-webhook,chat:write"),x=`${u}?client_id=${k}&scope=${r}&redirect_uri=${o}`;window.open(x,"_blank","noopener,noreferrer")},D=async o=>{try{await v.delete(`/plugins/${l}/oauth/workspaces/${o}`),s&&s({variant:"success",body:"Workspace disconnected successfully!"}),f()}catch(r){s&&s({variant:"error",body:r.message||"Failed to disconnect workspace."})}},O=async(o,r)=>{try{await v.patch(`/plugins/${l}/oauth/workspaces/${o}`,{is_active:!r}),s&&s({variant:"success",body:"Workspace status updated successfully!"}),f()}catch(x){s&&s({variant:"error",body:x.message||"Failed to update workspace status."})}},F=async()=>{if(i.length!==0)try{await Promise.all(i.map(o=>v.patch(`/plugins/${l}/oauth/workspaces/${o.id}`,{routing_type:g}))),s&&s({variant:"success",body:`Notification routing updated for all ${i.length} workspace(s)!`}),f()}catch(o){s&&s({variant:"error",body:o.message||"Failed to apply routing settings."})}},U=(o,r)=>{C(r)},V=o=>{H(parseInt(o.target.value,10)),C(0)};return e.jsxs(n.Box,{children:[e.jsx(n.Typography,{variant:"body2",color:"text.secondary",fontSize:13,sx:{mb:3},children:"Connect your Slack workspace and route VerifyWise notifications to specific channels."}),e.jsxs(n.Stack,{direction:"row",justifyContent:"flex-end",spacing:2,sx:{mb:3},children:[e.jsx("a",{href:"#",onClick:o=>{o.preventDefault(),N()},children:e.jsx("img",{alt:"Add to Slack",height:"34",width:"120",src:"https://platform.slack-edge.com/img/add_to_slack.png",srcSet:"https://platform.slack-edge.com/img/add_to_slack.png 1x, https://platform.slack-edge.com/img/add_to_slack@2x.png 2x"})}),e.jsx(n.Button,{variant:"contained",startIcon:e.jsx(B,{size:18}),onClick:()=>S(!0),disabled:i.length===0,sx:{height:"34px",backgroundColor:t.primary,textTransform:"none",fontSize:d.sizes.md,fontWeight:d.weights.medium,"&:hover":{backgroundColor:t.primaryHover},"&:disabled":{backgroundColor:t.disabled}},children:"Configure"})]}),P?e.jsxs(n.Box,{sx:{display:"flex",alignItems:"center",gap:2,py:4},children:[e.jsx(n.CircularProgress,{size:24}),e.jsx(n.Typography,{fontSize:13,children:"Loading workspaces..."})]}):e.jsx(n.TableContainer,{sx:{border:`1px solid ${t.border}`,borderRadius:W.md},children:e.jsxs(n.Table,{children:[e.jsx(n.TableHead,{sx:{backgroundColor:t.backgroundSecondary},children:e.jsxs(n.TableRow,{children:[e.jsx(n.TableCell,{sx:{...c.header},children:"Team Name"}),e.jsx(n.TableCell,{sx:{...c.header},children:"Channel"}),e.jsx(n.TableCell,{sx:{...c.header},children:"Creation Date"}),e.jsx(n.TableCell,{sx:{...c.header},children:"Active"}),e.jsx(n.TableCell,{sx:{...c.header},children:"Action"})]})}),e.jsx(n.TableBody,{children:i.length>0?i.slice(y*w,y*w+w).map(o=>e.jsxs(n.TableRow,{sx:{...c.row},children:[e.jsx(n.TableCell,{sx:{...c.cell},children:o.team_name}),e.jsxs(n.TableCell,{sx:{...c.cell},children:["#",o.channel]}),e.jsx(n.TableCell,{sx:{...c.cell},children:o.created_at?new Date(o.created_at).toLocaleDateString():"-"}),e.jsx(n.TableCell,{sx:{...c.cell},children:o.is_active?"Yes":"No"}),e.jsx(n.TableCell,{sx:{...c.cell},children:e.jsxs(n.Stack,{direction:"row",spacing:1,children:[e.jsx(n.Button,{size:"small",variant:"outlined",onClick:()=>O(o.id,o.is_active),sx:{minWidth:"auto",px:1,fontSize:d.sizes.sm,textTransform:"none",borderColor:t.border,color:t.textSecondary},title:o.is_active?"Disable":"Enable",children:o.is_active?e.jsx(E,{size:16}):e.jsx(A,{size:16})}),e.jsx(n.Button,{size:"small",variant:"outlined",color:"error",onClick:()=>D(o.id),sx:{minWidth:"auto",px:1,fontSize:d.sizes.sm,textTransform:"none"},title:"Delete",children:e.jsx(L,{size:16})})]})})]},o.id)):e.jsx(n.TableRow,{children:e.jsx(n.TableCell,{colSpan:5,align:"center",sx:{py:4},children:e.jsx(n.Typography,{fontSize:13,color:"text.secondary",children:'No workspaces connected yet. Click "Add to Slack" above to connect.'})})})}),i.length>5&&e.jsx(n.TableFooter,{children:e.jsx(n.TableRow,{children:e.jsx(n.TablePagination,{count:i.length,page:y,onPageChange:U,rowsPerPage:w,rowsPerPageOptions:[5,10,15,25],onRowsPerPageChange:V,labelRowsPerPage:"Rows per page",sx:{fontSize:"13px"}})})})]})}),M&&e.jsx(n.Box,{sx:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:9999},onClick:()=>S(!1),children:e.jsxs(n.Box,{sx:{backgroundColor:t.background,borderRadius:W.md,p:3,maxWidth:"600px",width:"90%"},onClick:o=>o.stopPropagation(),children:[e.jsx(n.Typography,{variant:"h6",fontWeight:600,fontSize:16,sx:{mb:2},children:"Notification Routing"}),e.jsx(n.Typography,{variant:"body2",color:"text.secondary",fontSize:13,sx:{mb:3},children:"Configure which notification types go to which Slack channels."}),e.jsxs(n.Stack,{spacing:2,sx:{mb:3},children:[e.jsx(n.Typography,{variant:"subtitle2",fontWeight:500,fontSize:13,children:"Apply to all workspaces:"}),e.jsx(n.FormControl,{fullWidth:!0,size:"small",children:e.jsx(n.Select,{multiple:!0,value:g,onChange:o=>{const r=typeof o.target.value=="string"?o.target.value.split(","):o.target.value;$(r)},renderValue:o=>o.length===0?"Select notification types...":`${o.length} type(s) selected`,displayEmpty:!0,sx:{fontSize:"13px"},children:["Membership and roles","Projects and organizations","Policy reminders and status","Evidence and task alerts","Control or policy changes"].map(o=>e.jsxs(n.MenuItem,{value:o,sx:{fontSize:"13px"},children:[e.jsx(n.Checkbox,{checked:g.indexOf(o)>-1,sx:{color:t.primary,"&.Mui-checked":{color:t.primary}}}),e.jsx(n.Typography,{fontSize:13,children:o})]},o))})})]}),e.jsxs(n.Stack,{direction:"row",spacing:2,justifyContent:"flex-end",children:[e.jsx(n.Button,{variant:"outlined",onClick:()=>S(!1),sx:{textTransform:"none",fontSize:d.sizes.md},children:"Cancel"}),e.jsx(n.Button,{variant:"contained",onClick:()=>{F(),S(!1)},disabled:g.length===0,sx:{backgroundColor:t.primary,textTransform:"none",fontSize:d.sizes.md,"&:hover":{backgroundColor:t.primaryHover}},children:"Save Changes"})]})]})})]})};return T.SlackConfiguration=I,Object.defineProperty(T,Symbol.toStringTag,{value:"Module"}),T}({},jsxRuntime,React,MUI);
//# sourceMappingURL=index.esm.js.map
